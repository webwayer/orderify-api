import * as passport from 'passport'
import { Strategy as FacebookStrategy } from 'passport-facebook'

export function passportFactory(config: FACEBOOK_CONFIG) {
    passport.use(new FacebookStrategy({
        clientID: config.FACEBOOK_CLIENT_ID,
        clientSecret: config.FACEBOOK_CLIENT_SECRET,
        callbackURL: config.FACEBOOK_CALLBACK_URL,
    },
        function (accessToken, refreshToken, profile, cb) {
            cb(null, profile);
        }
    ))

    passport.serializeUser(function (user, done) {
        done(null, user);
    });
    
    passport.deserializeUser(function (user, done) {
        done(null, user);
    });

    return passport;
}

export interface FACEBOOK_CONFIG {
    FACEBOOK_CLIENT_ID: string,
    FACEBOOK_CLIENT_SECRET: string,
    FACEBOOK_CALLBACK_URL: string,
}